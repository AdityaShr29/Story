This is the modified chapter 3 inside the branch.